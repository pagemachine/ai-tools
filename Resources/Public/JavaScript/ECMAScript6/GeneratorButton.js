import t from"jquery";import{c as a}from"./RemoteCalls.js";class e{static CSS_CLASSES={TRIGGER:"t3js-alternative-generator-trigger",CLICK_HANDLED:"click-handled",GENERATING:"generating",AI_TOOLS_GENERATING:"t3js-ai-tools-generating"};updateHook=null;constructor(){this.initGeneratorButton()}initGeneratorButton(){const a=t(`.${e.CSS_CLASSES.TRIGGER}`).not(`.${e.CSS_CLASSES.CLICK_HANDLED}`);a.addClass(e.CSS_CLASSES.CLICK_HANDLED),a.on("click",(a=>{a.preventDefault(),a.stopPropagation(),this.triggerGeneratorButton(t(a.currentTarget))}))}async triggerGeneratorButton(r){const o=r.data("file-identifier"),S=r.data("target-language"),n=t(r.data("output-target")),i=r.data("show-target");let s=r.data("text-prompt"),l=r.data("text-prompt-language")||"auto";r.data("text-prompt-field")&&(s=t(r.data("text-prompt-field")).val(),l=t(r.data("text-prompt-field")).attr("data-text-prompt-language")||l);let d=r.data("translation-provider");r.prop("disabled",!0),r.addClass(e.CSS_CLASSES.GENERATING),n.prop("disabled",!0),n.addClass(e.CSS_CLASSES.AI_TOOLS_GENERATING);try{const t=await a(o,S,s,l,d);console.log("Prompt generated",t),n.val(t.alternative),n.trigger("change"),this.updateHook&&this.updateHook(n,t)}finally{r.prop("disabled",!1),r.removeClass(e.CSS_CLASSES.GENERATING),n.prop("disabled",!1),n.removeClass(e.CSS_CLASSES.AI_TOOLS_GENERATING),i&&t(i).show()}}}export{e as G};
