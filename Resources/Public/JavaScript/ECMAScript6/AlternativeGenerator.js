import t from"jquery";import e from"@typo3/backend/modal.js";import{MessageUtility as a}from"@typo3/backend/utility/message-utility.js";import{G as i}from"./GeneratorButton-e6835ac8.js";import r from"@typo3/backend/form-engine.js";import"./RemoteCalls-cb01fbef.js";var n=new class{currentModal=null;triggerTarget=null;constructor(){this.initializeListener(),this.initializeTrigger()}initializeListener(){window.addEventListener("message",(t=>{if(!a.verifyOrigin(t.origin))throw"Denied message sent by "+t.origin;if("typo3:aiTools:updateField"===t.data.actionName){if(void 0===t.data.value)throw"value not defined in message";this.currentModal&&(this.triggerTarget.val(t.data.value),this.triggerTarget.trigger("change"),this.triggerUpdate(this.triggerTarget),this.currentModal.hideModal())}}))}initializeTrigger(){(new i).updateHook=(t,e)=>{this.triggerUpdate(t)},t(".t3js-alternative-generator-settings-trigger").off("click").on("click",(t=>this.clickSettingsHandler(t)))}triggerUpdate(t){t.get(0).dispatchEvent(new Event("change")),void 0!==r&&r.Validation&&(r.Validation.validateField(t.get(0)),r.Validation.markFieldAsChanged(t.get(0)))}clickSettingsHandler(e){e.preventDefault(),e.stopPropagation(),this.show(t(e.currentTarget))}show(a){this.currentModal=e.advanced({additionalCssClasses:["modal-image-manipulation"],buttons:[],staticBackdrop:!0,content:a.data("base")+"&modal=1&target="+encodeURIComponent(a.data("target"))+"&target-language="+encodeURIComponent(a.data("target-language")),type:e.types.iframe,size:e.sizes.large,title:a.data("title")}),this.triggerTarget=t(a.data("output-target")),currentModal.css&&currentModal.css("pointer-events","none")}};export{n as default};
