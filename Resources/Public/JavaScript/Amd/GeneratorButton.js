define(["exports","jquery","./RemoteCalls"],(function(t,a,e){"use strict";function r(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var o=r(a);class n{static CSS_CLASSES={TRIGGER:"t3js-alternative-generator-trigger",CLICK_HANDLED:"click-handled",GENERATING:"generating",AI_TOOLS_GENERATING:"t3js-ai-tools-generating"};updateHook=null;constructor(){this.initGeneratorButton()}initGeneratorButton(){const t=o.default(`.${n.CSS_CLASSES.TRIGGER}`).not(`.${n.CSS_CLASSES.CLICK_HANDLED}`);t.addClass(n.CSS_CLASSES.CLICK_HANDLED),t.on("click",(t=>{t.preventDefault(),t.stopPropagation(),this.triggerGeneratorButton(o.default(t.currentTarget))}))}async triggerGeneratorButton(t){const a=t.data("file-identifier"),r=t.data("target-language"),l=o.default(t.data("output-target")),d=t.data("show-target");let S=t.data("text-prompt"),i=t.data("text-prompt-language")||"auto";t.data("text-prompt-field")&&(S=o.default(t.data("text-prompt-field")).val(),i=o.default(t.data("text-prompt-field")).attr("data-text-prompt-language")||i);let s=t.data("translation-provider");t.prop("disabled",!0),t.addClass(n.CSS_CLASSES.GENERATING),l.prop("disabled",!0),l.addClass(n.CSS_CLASSES.AI_TOOLS_GENERATING);try{const t=await e.callAjaxMetaGenerateAction(a,r,S,i,s);console.log("Prompt generated",t),l.val(t.alternative),l.trigger("change"),this.updateHook&&this.updateHook(l,t)}finally{t.prop("disabled",!1),t.removeClass(n.CSS_CLASSES.GENERATING),l.prop("disabled",!1),l.removeClass(n.CSS_CLASSES.AI_TOOLS_GENERATING),d&&o.default(d).show()}}}t.GeneratorButton=n}));
