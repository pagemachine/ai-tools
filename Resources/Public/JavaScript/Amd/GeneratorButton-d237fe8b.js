define(["exports","jquery","./RemoteCalls-fa38ce14"],(function(t,e,a){"use strict";function l(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var r=l(e);class i{static CSS_CLASSES={TRIGGER:"t3js-alternative-generator-trigger",CLICK_HANDLED:"click-handled",GENERATING:"generating",AI_TOOLS_GENERATING:"t3js-ai-tools-generating"};updateHook=null;constructor(){this.initGeneratorButton()}initGeneratorButton(){const t=r.default(`.${i.CSS_CLASSES.TRIGGER}`).not(`.${i.CSS_CLASSES.CLICK_HANDLED}`);t.addClass(i.CSS_CLASSES.CLICK_HANDLED),t.on("click",(t=>{t.preventDefault(),t.stopPropagation(),this.triggerGeneratorButton(r.default(t.currentTarget))}))}async triggerGeneratorButton(t){const e=t.data("file-identifier"),l=t.data("target-language"),d=r.default(t.data("output-target")),o=t.data("show-target");let n=t.data("text-prompt");t.data("text-prompt-field")&&(n=r.default(t.data("text-prompt-field")).val());let s=t.data("text-imagelabel"),S=t.data("text-imagelabel");t.data("text-imagelabel-field")&&(s=t.data("text-imagelabel-field"),S=r.default(t.data("text-imagelabel-field")).val());let u="";r.default("#tag-div-"+s.replace("#selectedimageLabel-","")).children().not(".reset-tag").each((function(){"inline-block"===r.default(this).css("display")&&(u+=r.default(this).data("value")+",")})),u=u.replace(/,$/,""),t.prop("disabled",!0),t.addClass(i.CSS_CLASSES.GENERATING),d.prop("disabled",!0),d.addClass(i.CSS_CLASSES.AI_TOOLS_GENERATING);try{const t=await a.callAjaxMetaGenerateAction(e,l,n,S,u);console.log("Prompt generated",t),d.val(t.alternative),d.trigger("change"),this.updateHook&&this.updateHook(d,t)}finally{t.prop("disabled",!1),t.removeClass(i.CSS_CLASSES.GENERATING),d.prop("disabled",!1),d.removeClass(i.CSS_CLASSES.AI_TOOLS_GENERATING),o&&r.default(o).show()}}}t.GeneratorButton=i}));
