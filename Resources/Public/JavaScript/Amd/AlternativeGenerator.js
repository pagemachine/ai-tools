define(["jquery","TYPO3/CMS/Backend/Modal","TYPO3/CMS/Backend/Utility/MessageUtility","./GeneratorButton-13440e8e","TYPO3/CMS/Backend/FormEngine","./RemoteCalls-1b4ca95c"],(function(t,e,a,i,n,r){"use strict";function d(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var l=d(t),o=d(e),s=d(n);return new class{currentModal=null;triggerTarget=null;constructor(){this.initializeListener(),this.initializeTrigger()}initializeListener(){window.addEventListener("message",(t=>{if(!a.MessageUtility.verifyOrigin(t.origin))throw"Denied message sent by "+t.origin;if("typo3:aiTools:updateField"===t.data.actionName){if(void 0===t.data.value)throw"value not defined in message";this.currentModal&&(this.triggerTarget.val(t.data.value),this.triggerTarget.trigger("change"),this.triggerUpdate(this.triggerTarget),this.currentModal.hideModal())}}))}initializeTrigger(){(new i.GeneratorButton).updateHook=(t,e)=>{this.triggerUpdate(t)},l.default(".t3js-alternative-generator-settings-trigger").off("click").on("click",(t=>this.clickSettingsHandler(t)))}triggerUpdate(t){t.get(0).dispatchEvent(new Event("change")),void 0!==s.default&&s.default.Validation&&(s.default.Validation.validateField(t.get(0)),s.default.Validation.markFieldAsChanged(t.get(0)))}clickSettingsHandler(t){t.preventDefault(),t.stopPropagation(),this.show(l.default(t.currentTarget))}show(t){this.currentModal=o.default.advanced({additionalCssClasses:["modal-image-manipulation"],buttons:[],staticBackdrop:!0,content:t.data("base")+"&modal=1&target="+encodeURIComponent(t.data("target"))+"&target-language="+encodeURIComponent(t.data("target-language")),type:o.default.types.iframe,size:o.default.sizes.large,title:t.data("title")}),this.triggerTarget=l.default(t.data("output-target")),currentModal.css&&currentModal.css("pointer-events","none")}}}));
